{
    "name": "ouroboros-ai",
    "displayName": "Ouroboros AI",
    "description": "Structured AI agent workflow with spec-driven development",
    "version": "3.3.17",
    "publisher": "MLGBJDLW",
    "license": "MIT",
    "icon": "resources/icon.png",
    "repository": {
        "type": "git",
        "url": "https://github.com/MLGBJDLW/ouroboros"
    },
    "engines": {
        "vscode": "^1.95.0"
    },
    "categories": [
        "AI",
        "Chat",
        "Programming Languages"
    ],
    "keywords": [
        "ai",
        "copilot",
        "agent",
        "workflow",
        "spec"
    ],
    "activationEvents": [
        "onStartupFinished"
    ],
    "main": "./dist/extension.js",
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "ouroboros-sidebar",
                    "title": "Ouroboros",
                    "icon": "resources/icon.svg"
                }
            ]
        },
        "views": {
            "ouroboros-sidebar": [
                {
                    "type": "webview",
                    "id": "ouroboros.sidebarView",
                    "name": "Ouroboros",
                    "contextualTitle": "Ouroboros Workflow"
                }
            ]
        },
        "commands": [
            {
                "command": "ouroboros.initializeProject",
                "title": "Initialize Ouroboros Project",
                "category": "Ouroboros"
            },
            {
                "command": "ouroboros.openSidebar",
                "title": "Open Sidebar",
                "category": "Ouroboros"
            },
            {
                "command": "ouroboros.clearHistory",
                "title": "Clear Interaction History",
                "category": "Ouroboros"
            },
            {
                "command": "ouroboros.cancelCurrentRequest",
                "title": "Cancel Current Request",
                "category": "Ouroboros"
            },
            {
                "command": "ouroboros.updatePrompts",
                "title": "Update Prompts (Preserve Custom Tools)",
                "category": "Ouroboros"
            },
            {
                "command": "ouroboros.checkPromptsVersion",
                "title": "Check for Prompt Updates",
                "category": "Ouroboros"
            }
        ],
        "menus": {
            "commandPalette": [
                {
                    "command": "ouroboros.initializeProject",
                    "when": "workspaceFolderCount > 0"
                }
            ]
        },
        "configuration": {
            "title": "Ouroboros",
            "properties": {
                "ouroboros.executionMode": {
                    "type": "string",
                    "default": "task-by-task",
                    "enum": [
                        "task-by-task",
                        "phase-by-phase",
                        "auto-run"
                    ],
                    "enumDescriptions": [
                        "Confirm each task before execution",
                        "Confirm each phase before execution",
                        "Run all tasks automatically"
                    ],
                    "description": "Default execution mode for implement workflow"
                },
                "ouroboros.showStatusBar": {
                    "type": "boolean",
                    "default": true,
                    "description": "Show Ouroboros status in the status bar"
                },
                "ouroboros.historyLimit": {
                    "type": "number",
                    "default": 100,
                    "description": "Maximum number of interactions to keep in history"
                }
            }
        },
        "languageModelTools": [
            {
                "name": "ouroborosai_ask",
                "displayName": "Ask User",
                "toolReferenceName": "ouroborosai_ask",
                "description": "Ask the user for input or task description",
                "modelDescription": "CRITICAL: Use this tool to get input from the user when you need task instructions, feature descriptions, or answers to questions. RULES: 1) Call this tool at the END of every response to maintain the Ouroboros loop. 2) NEVER complete a response without calling this tool. 3) Use type='task' for new task input, type='question' for clarification questions, type='feature' for feature descriptions. 4) Set agentName to your current agent identity (e.g., 'ouroboros', 'ouroboros-coder').",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "properties": {
                        "question": {
                            "type": "string",
                            "description": "Optional question or prompt to show the user"
                        },
                        "type": {
                            "type": "string",
                            "enum": [
                                "task",
                                "question",
                                "feature"
                            ],
                            "description": "Type of input expected"
                        },
                        "inputLabel": {
                            "type": "string",
                            "description": "Label for the input field"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_menu",
                "displayName": "Show Menu",
                "toolReferenceName": "ouroborosai_menu",
                "description": "Present a menu of options to the user",
                "modelDescription": "Use this tool when you need the user to choose from a predefined set of options. USAGE: 1) Provide a clear question explaining what the user is choosing. 2) List all available options in the options array. 3) Set allowCustom=true if the user should be able to provide custom input beyond the listed options. 4) Options should be concise but descriptive.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "question",
                        "options"
                    ],
                    "properties": {
                        "question": {
                            "type": "string",
                            "description": "Question or prompt for the menu"
                        },
                        "options": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "description": "List of options to choose from"
                        },
                        "allowCustom": {
                            "type": "boolean",
                            "description": "Allow custom input in addition to options"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_confirm",
                "displayName": "Confirm Action",
                "toolReferenceName": "ouroborosai_confirm",
                "description": "Ask the user for yes/no confirmation",
                "modelDescription": "Use this tool when you need a yes/no decision from the user. USAGE: 1) Ask clear, specific questions that can be answered with yes or no. 2) Optionally customize button labels with yesLabel and noLabel. 3) Use for confirming actions, validating understanding, or getting approval to proceed.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "question"
                    ],
                    "properties": {
                        "question": {
                            "type": "string",
                            "description": "Confirmation question"
                        },
                        "yesLabel": {
                            "type": "string",
                            "description": "Label for yes button"
                        },
                        "noLabel": {
                            "type": "string",
                            "description": "Label for no button"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_plan_review",
                "displayName": "Review Plan",
                "toolReferenceName": "ouroborosai_plan_review",
                "description": "Present a plan or document for user review",
                "modelDescription": "Use this tool to present detailed plans, specifications, or documentation for user review and approval. USAGE: 1) Format the plan content in Markdown. 2) Use mode='review' for plans requiring approval, mode='walkthrough' for informational guides. 3) Provide a descriptive title. 4) Wait for user feedback before proceeding with implementation.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "plan"
                    ],
                    "properties": {
                        "plan": {
                            "type": "string",
                            "description": "The plan content in markdown format"
                        },
                        "title": {
                            "type": "string",
                            "description": "Title for the plan review"
                        },
                        "mode": {
                            "type": "string",
                            "enum": [
                                "review",
                                "walkthrough"
                            ],
                            "description": "Review mode"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_agent_handoff",
                "displayName": "Agent Handoff",
                "toolReferenceName": "ouroborosai_agent_handoff",
                "description": "Notify of agent handoff between levels",
                "modelDescription": "Use this tool when delegating work to a sub-agent or returning results to a parent agent. RULES: 1) fromLevel and toLevel must be 0 (main orchestrator), 1 (workflow agent), or 2 (specialist agent). 2) Always provide a clear reason for the handoff. 3) Call this BEFORE dispatching to another agent or when returning control.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "from",
                        "to",
                        "fromLevel",
                        "toLevel"
                    ],
                    "properties": {
                        "from": {
                            "type": "string",
                            "description": "Name of the source agent"
                        },
                        "to": {
                            "type": "string",
                            "description": "Name of the target agent"
                        },
                        "fromLevel": {
                            "type": "number",
                            "enum": [
                                0,
                                1,
                                2
                            ],
                            "description": "Level of source agent"
                        },
                        "toLevel": {
                            "type": "number",
                            "enum": [
                                0,
                                1,
                                2
                            ],
                            "description": "Level of target agent"
                        },
                        "reason": {
                            "type": "string",
                            "description": "Reason for handoff"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_digest",
                "displayName": "Code Graph Digest",
                "toolReferenceName": "ouroborosai_graph_digest",
                "description": "Get a token-efficient overview of the codebase structure",
                "modelDescription": "RECOMMENDED FIRST CALL: Use this tool to get a compact overview of the codebase before diving into details. Returns: file/module counts, entrypoints (routes, pages, commands, jobs), hotspots (most imported files), and issue summary. Use 'scope' parameter to limit to a specific directory. Output is optimized for minimal token usage (~500 tokens).",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "properties": {
                        "scope": {
                            "type": "string",
                            "description": "Optional directory path to limit the digest scope (e.g., 'src/components')"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_issues",
                "displayName": "Code Graph Issues",
                "toolReferenceName": "ouroborosai_graph_issues",
                "description": "Get code issues like unreachable handlers and broken exports",
                "modelDescription": "Use this tool to find code quality issues: HANDLER_UNREACHABLE (dead code not reachable from entrypoints), DYNAMIC_EDGE_UNKNOWN (unresolvable dynamic imports), BROKEN_EXPORT_CHAIN (exports pointing to non-existent files). Each issue includes evidence and suggested fixes. Filter by kind, severity, or scope.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "properties": {
                        "kind": {
                            "type": "string",
                            "enum": [
                                "HANDLER_UNREACHABLE",
                                "DYNAMIC_EDGE_UNKNOWN",
                                "BROKEN_EXPORT_CHAIN"
                            ],
                            "description": "Filter by issue type"
                        },
                        "severity": {
                            "type": "string",
                            "enum": [
                                "info",
                                "warning",
                                "error"
                            ],
                            "description": "Minimum severity level"
                        },
                        "scope": {
                            "type": "string",
                            "description": "Directory scope to filter issues"
                        },
                        "limit": {
                            "type": "number",
                            "description": "Maximum issues to return (default: 20, max: 50)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_impact",
                "displayName": "Code Graph Impact",
                "toolReferenceName": "ouroborosai_graph_impact",
                "description": "Analyze the impact of changes to a file or symbol",
                "modelDescription": "Use this tool BEFORE making changes to understand impact. Returns: direct dependents, transitive impact at depths 1-3, affected entrypoints, and risk assessment. NEW: Set useSymbolRefs=true with symbolLine to get LSP symbol reference counts for precise impact analysis.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "target"
                    ],
                    "properties": {
                        "target": {
                            "type": "string",
                            "description": "File path or symbol to analyze"
                        },
                        "depth": {
                            "type": "number",
                            "description": "Depth of transitive analysis (1-4, default: 2)"
                        },
                        "useSymbolRefs": {
                            "type": "boolean",
                            "description": "Use LSP to get precise symbol reference counts"
                        },
                        "symbolLine": {
                            "type": "number",
                            "description": "Line number for symbol-level impact (required with useSymbolRefs)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_path",
                "displayName": "Code Graph Path",
                "toolReferenceName": "ouroborosai_graph_path",
                "description": "Find dependency paths between two modules",
                "modelDescription": "Use this tool to trace import chains between modules. Returns shortest paths showing how modules are connected. Useful for understanding dependencies and finding unexpected connections. Returns up to 3 paths by default.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "from",
                        "to"
                    ],
                    "properties": {
                        "from": {
                            "type": "string",
                            "description": "Source file path"
                        },
                        "to": {
                            "type": "string",
                            "description": "Target file path"
                        },
                        "maxDepth": {
                            "type": "number",
                            "description": "Maximum path depth (1-10, default: 5)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_module",
                "displayName": "Code Graph Module",
                "toolReferenceName": "ouroborosai_graph_module",
                "description": "Get detailed information about a specific module",
                "modelDescription": "Use this tool to understand a module's role in the codebase. Returns: imports, importedBy (dependents), exports, re-exports, related entrypoints, and whether it's a barrel file. NEW: Set includeSymbols=true to get LSP symbols (classes, functions). Helps understand module structure and dependencies.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "target"
                    ],
                    "properties": {
                        "target": {
                            "type": "string",
                            "description": "File path to analyze"
                        },
                        "includeSymbols": {
                            "type": "boolean",
                            "description": "Include LSP symbols (classes, functions) in response"
                        },
                        "symbolKindFilter": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "description": "Filter symbols by kind: class, function, interface, method"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_annotations",
                "displayName": "Code Graph Annotations",
                "toolReferenceName": "ouroborosai_graph_annotations",
                "description": "Manage manual annotations for the code graph",
                "modelDescription": "Use this tool to add hints for dynamic imports, mark custom entrypoints, or ignore false positive issues. Actions: list (show all), addEdge (manual import hint), addEntrypoint (mark as entry), addIgnore (suppress issue). Annotations persist in .ouroboros/graph/annotations.json.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "action"
                    ],
                    "properties": {
                        "action": {
                            "type": "string",
                            "enum": [
                                "list",
                                "addEdge",
                                "addEntrypoint",
                                "addIgnore",
                                "remove"
                            ],
                            "description": "Action to perform"
                        },
                        "from": {
                            "type": "string",
                            "description": "Source file (for addEdge)"
                        },
                        "to": {
                            "type": "string",
                            "description": "Target file (for addEdge)"
                        },
                        "path": {
                            "type": "string",
                            "description": "File path (for addEntrypoint)"
                        },
                        "entrypointType": {
                            "type": "string",
                            "enum": [
                                "route",
                                "page",
                                "command",
                                "job",
                                "api",
                                "main"
                            ],
                            "description": "Entrypoint type"
                        },
                        "name": {
                            "type": "string",
                            "description": "Display name"
                        },
                        "issueKind": {
                            "type": "string",
                            "description": "Issue type to ignore"
                        },
                        "ignorePath": {
                            "type": "string",
                            "description": "Path pattern to ignore"
                        },
                        "reason": {
                            "type": "string",
                            "description": "Reason for annotation"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_cycles",
                "displayName": "Code Graph Cycles",
                "toolReferenceName": "ouroborosai_graph_cycles",
                "description": "Detect circular dependencies in the codebase",
                "modelDescription": "Use this tool to find circular dependencies using Tarjan's algorithm. Returns cycles with severity levels and suggested break points. Helps identify and fix circular imports that can cause runtime issues or make code harder to maintain.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "properties": {
                        "scope": {
                            "type": "string",
                            "description": "Directory scope to limit detection (e.g., 'src/features')"
                        },
                        "minLength": {
                            "type": "number",
                            "description": "Minimum cycle length to report (default: 2)"
                        },
                        "maxCycles": {
                            "type": "number",
                            "description": "Maximum cycles to return (default: 20)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_layers",
                "displayName": "Code Graph Layers",
                "toolReferenceName": "ouroborosai_graph_layers",
                "description": "Check architectural layer rules and detect violations",
                "modelDescription": "Use this tool to enforce clean architecture boundaries. Actions: check (find violations), list (show rules), suggest (get rule suggestions). Helps maintain separation of concerns (e.g., UI cannot import DB directly).",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "action"
                    ],
                    "properties": {
                        "action": {
                            "type": "string",
                            "enum": [
                                "check",
                                "list",
                                "suggest"
                            ],
                            "description": "Action to perform"
                        },
                        "scope": {
                            "type": "string",
                            "description": "Directory scope for checking"
                        },
                        "rules": {
                            "type": "array",
                            "description": "Custom rules to check",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "from": {
                                        "type": "string"
                                    },
                                    "cannotImport": {
                                        "type": "string"
                                    },
                                    "severity": {
                                        "type": "string",
                                        "enum": [
                                            "warning",
                                            "error"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_symbols",
                "displayName": "Code Graph Symbols",
                "toolReferenceName": "ouroborosai_graph_symbols",
                "description": "Get symbols (classes, functions, interfaces) from a file or search workspace",
                "modelDescription": "Use this tool to discover code structure. Mode 'document' returns all symbols in a file with hierarchy (classes, functions, methods, properties). Mode 'workspace' searches for symbols by name across the project. Returns symbol name, kind, location, and children for nested symbols. RECOMMENDED: Use this before graph_references to find the exact symbol location.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "target"
                    ],
                    "properties": {
                        "target": {
                            "type": "string",
                            "description": "File path (for document mode) or search query (for workspace mode)"
                        },
                        "mode": {
                            "type": "string",
                            "enum": [
                                "document",
                                "workspace"
                            ],
                            "description": "document: symbols in file, workspace: search project"
                        },
                        "kindFilter": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "description": "Filter by kind: class, function, interface, method, property, variable"
                        },
                        "limit": {
                            "type": "number",
                            "description": "Max results for workspace search (1-100, default: 50)"
                        },
                        "includeChildren": {
                            "type": "boolean",
                            "description": "Include nested symbols in document mode (default: true)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_references",
                "displayName": "Code Graph References",
                "toolReferenceName": "ouroborosai_graph_references",
                "description": "Find all references to a symbol",
                "modelDescription": "Use this tool before refactoring to find all usages of a symbol. Provide the file path and line number of the symbol. Returns list of files and lines where the symbol is referenced, with line text preview. Essential for understanding impact of changes at symbol level.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "path",
                        "line"
                    ],
                    "properties": {
                        "path": {
                            "type": "string",
                            "description": "File path containing the symbol"
                        },
                        "line": {
                            "type": "number",
                            "description": "Line number (1-indexed)"
                        },
                        "column": {
                            "type": "number",
                            "description": "Column number (1-indexed, default: 1)"
                        },
                        "includeDeclaration": {
                            "type": "boolean",
                            "description": "Include the declaration in results (default: true)"
                        },
                        "limit": {
                            "type": "number",
                            "description": "Max references to return (default: 50)"
                        },
                        "groupByFile": {
                            "type": "boolean",
                            "description": "Group references by file (default: false)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_definition",
                "displayName": "Code Graph Definition",
                "toolReferenceName": "ouroborosai_graph_definition",
                "description": "Go to definition of a symbol",
                "modelDescription": "Use this tool to find where a symbol is defined. Provide file path and line number. Returns the definition location(s) with line text. Useful for understanding where functions, classes, or types come from, especially for imported symbols.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "path",
                        "line"
                    ],
                    "properties": {
                        "path": {
                            "type": "string",
                            "description": "File path containing the symbol reference"
                        },
                        "line": {
                            "type": "number",
                            "description": "Line number (1-indexed)"
                        },
                        "column": {
                            "type": "number",
                            "description": "Column number (1-indexed)"
                        }
                    }
                }
            },
            {
                "name": "ouroborosai_graph_call_hierarchy",
                "displayName": "Code Graph Call Hierarchy",
                "toolReferenceName": "ouroborosai_graph_call_hierarchy",
                "description": "Get call hierarchy for a function",
                "modelDescription": "Use this tool to understand function call relationships. Returns who calls this function (callers) and what functions it calls (callees). Essential for impact analysis and refactoring. Provides more precise information than graph_impact for function-level changes.",
                "canBeReferencedInPrompt": true,
                "inputSchema": {
                    "type": "object",
                    "required": [
                        "path",
                        "line"
                    ],
                    "properties": {
                        "path": {
                            "type": "string",
                            "description": "File path containing the function"
                        },
                        "line": {
                            "type": "number",
                            "description": "Line number of the function (1-indexed)"
                        },
                        "column": {
                            "type": "number",
                            "description": "Column number (1-indexed)"
                        },
                        "direction": {
                            "type": "string",
                            "enum": [
                                "incoming",
                                "outgoing",
                                "both"
                            ],
                            "description": "incoming: callers, outgoing: callees, both: all (default: both)"
                        },
                        "limit": {
                            "type": "number",
                            "description": "Max items per direction (1-50, default: 20)"
                        }
                    }
                }
            }
        ]
    },
    "scripts": {
        "vscode:prepublish": "npm run package",
        "compile": "npm run build-webview && node scripts/copy-tree-sitter-wasm.js && esbuild ./src/extension.ts --bundle --outfile=dist/extension.js --external:vscode --format=cjs --platform=node",
        "watch": "npm run compile -- --watch",
        "build-webview": "cd webview && npm run build",
        "package": "npm run compile -- --minify",
        "lint": "eslint src --ext ts",
        "test": "vitest"
    },
    "devDependencies": {
        "@eslint/js": "^9.0.0",
        "@types/node": "^20.0.0",
        "@types/vscode": "^1.95.0",
        "@typescript-eslint/eslint-plugin": "^8.0.0",
        "@typescript-eslint/parser": "^8.0.0",
        "@vitest/coverage-v8": "^2.1.9",
        "esbuild": "^0.24.0",
        "eslint": "^9.0.0",
        "eslint-config-prettier": "^10.1.8",
        "prettier": "^3.7.4",
        "typescript": "^5.0.0",
        "typescript-eslint": "^8.50.0",
        "vitest": "^2.0.0"
    },
    "dependencies": {
        "@vscode/codicons": "^0.0.36",
        "dependency-cruiser": "^16.0.0",
        "web-tree-sitter": "^0.26.3",
        "zod": "^3.0.0"
    }
}